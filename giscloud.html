<!doctype html>

<html lang="en">
<head>
  <title>GIS Cloud</title>
  <script src="https://api.giscloud.com/1/api.js" type="text/javascript"></script>
  <script type="text/javascript">
	var mapId = 1522115,
    $ = giscloud.exposeJQuery();

	giscloud.apiKey("675af2b071491f3922eebe26ee803cbb");

	function setFeature (field_name, field_value) {
		var fid,priority;
	
        //find feature using layer id -> 967542 and feature id -> 1 
		giscloud.features.byLayer(1522116, {where: "workorder='" + field_value + "'"})
		    .done(function(features){
			    fid = features[0].id;
				priority= features[0].data.priority;
			});
        alert ("fid=" + fid + ",priority=" + priority + ",field_name="+field_name + ",field_value=" + field_value);
		giscloud.features.byId(1522116, fid, changeStatus);
		alert("update ok!");

	}

	function getFeature () {
	
	}
	
	function changeStatus (feature) {
        //change the status
        feature.data.status = "updated";
        //now just update feature
        feature.update();
		console.log(feature.data.status);
    }

  </script>
</head>

<body>
Hello GIS!
</body>
</html>